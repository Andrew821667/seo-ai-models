#!/usr/bin/env python3
"""
Тест улучшения контента по рекомендациям SEO AI Models.
"""

import sys
import os
import json
from pprint import pprint
from datetime import datetime

# Добавляем родительскую директорию в путь поиска модулей
sys.path.insert(0, os.path.abspath(os.path.join(os.path.dirname(os.path.abspath(__file__)), '..')))

from seo_ai_models.models.seo_advisor.enhanced_advisor import EnhancedSEOAdvisor

# Контент среднего уровня (на русском языке)
MEDIUM_QUALITY_CONTENT = """
# Руководство по SEO оптимизации для начинающих

Поисковая оптимизация (SEO) необходима для повышения видимости сайта в результатах поиска.
Без правильной оптимизации даже лучшие сайты могут остаться незамеченными потенциальными посетителями.

## Понимание основ

SEO включает множество факторов, влияющих на то, как поисковые системы ранжируют ваш сайт.
Основная цель - сделать ваш сайт более видимым, когда люди ищут релевантные темы.

## Техники оптимизации на странице

Оптимизация на странице относится ко всем мерам, которые вы можете принять непосредственно на своем сайте для улучшения его позиции в рейтингах поиска.

### Title Tags
Заголовки страниц важны как для SEO, так и для удобства пользователей. Убедитесь, что ваш заголовок содержит целевые ключевые слова.

### Мета-описания
Хотя мета-описания не оказывают прямого влияния на рейтинги, они могут улучшить показатель кликов из результатов поиска.

### Качество контента
Создавайте высококачественный, релевантный контент, который удовлетворяет потребности вашей аудитории.
Хороший контент должен быть информативным, увлекательным и предоставлять ценность читателям.

## Технические аспекты SEO

Технические аспекты вашего сайта могут значительно повлиять на его производительность в результатах поиска.

### Скорость сайта
Быстро загружающиеся сайты обеспечивают лучший пользовательский опыт и предпочтительны для поисковых систем.

### Адаптивность для мобильных устройств
С индексацией mobile-first наличие адаптивного сайта является необходимым условием для успеха в SEO.
"""

# Улучшенная версия контента на основе рекомендаций (на русском языке)
IMPROVED_CONTENT = """
# Полное руководство по SEO оптимизации для начинающих в 2025 году

Поисковая оптимизация (SEO) необходима для повышения видимости сайта в результатах поиска.
Без правильной оптимизации даже лучшие сайты могут остаться незамеченными потенциальными посетителями.
За более чем 5 лет работы с клиентами в сфере цифрового маркетинга я наблюдал, как сайты увеличивали
органический трафик на 300% после внедрения правильных практик SEO.

## Понимание основ SEO в современных реалиях

SEO включает множество факторов, влияющих на то, как поисковые системы ранжируют ваш сайт.
Основная цель - сделать ваш сайт более видимым, когда люди ищут релевантные темы.
Согласно недавним исследованиям Semrush (2024), сайты, появляющиеся на первой странице Google,
получают 91,5% всего поискового трафика.

### Как работают поисковые системы

Поисковые системы, такие как Google, используют сложные алгоритмы для определения того, какие страницы показывать для конкретных запросов.
Эти алгоритмы учитывают сотни факторов, включая:
- Релевантность и качество контента
- Структуру и навигацию сайта
- Скорость загрузки страниц
- Адаптивность для мобильных устройств
- Профиль обратных ссылок
- Метрики пользовательского взаимодействия

## Техники оптимизации на странице для максимального эффекта

Оптимизация на странице относится ко всем мерам, которые вы можете принять непосредственно на своем сайте для улучшения его позиции в рейтингах поиска.
Эти техники были подтверждены обширным A/B тестированием в нашем портфеле клиентов.

### Title Tags: Первое впечатление

Заголовки страниц важны как для SEO, так и для удобства пользователей. Убедитесь, что ваш заголовок содержит целевые ключевые слова.
Лучшие практики для заголовков:
- Держите заголовки в пределах 50-60 символов
- Размещайте важные ключевые слова ближе к началу
- Делайте каждый заголовок уникальным для всего сайта
- Включайте название бренда, когда это возможно

### Мета-описания, которые привлекают клики

Хотя мета-описания не оказывают прямого влияния на рейтинги, они могут улучшить показатель кликов из результатов поиска.
Эффективное мета-описание должно:
- Быть длиной 120-155 символов
- Включать призыв к действию
- Естественно содержать релевантные ключевые слова
- Точно резюмировать содержание страницы

### Качество контента и сигналы E-E-A-T

Создавайте высококачественный, релевантный контент, который удовлетворяет потребности вашей аудитории.
Хороший контент должен быть информативным, увлекательным и предоставлять ценность читателям.

Для демонстрации Опыта, Экспертизы, Авторитетности и Надежности (E-E-A-T):
- Включайте биографии авторов с указанием их квалификации
- Цитируйте уважаемые источники и исследования
- Регулярно обновляйте контент, добавляя актуальную информацию
- Обеспечивайте всестороннее освещение тем

## Технические аспекты SEO для лучшего ранжирования

Технические аспекты вашего сайта могут значительно повлиять на его производительность в результатах поиска.
Наши технические аудиты показали, что устранение этих факторов может улучшить рейтинги на 15-30%.

### Оптимизация скорости сайта

Быстро загружающиеся сайты обеспечивают лучший пользовательский опыт и предпочтительны для поисковых систем.
Согласно метрикам Google Web Vitals, сайты должны стремиться к следующим показателям:
- Largest Contentful Paint (LCP): < 2,5 секунды
- First Input Delay (FID): < 100 миллисекунд
- Cumulative Layout Shift (CLS): < 0,1

Техники для улучшения скорости сайта включают:
- Оптимизацию и сжатие изображений
- Минификацию CSS и JavaScript
- Внедрение кэширования в браузере
- Использование сети доставки контента (CDN)

### Адаптивность для мобильных устройств: обязательное требование

С индексацией mobile-first наличие адаптивного сайта является необходимым условием для успеха в SEO.
В 2024 году более 60% всех поисковых запросов приходят с мобильных устройств, согласно исследованиям Statista.

Ключевые аспекты мобильной оптимизации включают:
- Адаптивный дизайн, который приспосабливается к разным размерам экрана
- Сенсорно-дружественные элементы навигации
- Читаемый текст без необходимости масштабирования
- Правильно размеренные и расположенные кнопки и ссылки

## Измерение успеха SEO

Отслеживание правильных метрик является ключевым для понимания эффективности ваших усилий по SEO.
Настройте аналитику для мониторинга:
- Роста органического трафика
- Рейтингов ключевых слов
- Коэффициента конверсии от органического поиска
- Показателя отказов и времени на сайте
- Статистики сканирования и охвата индексации

## Распространенные ошибки SEO, которых следует избегать

На основе нашего опыта работы с сотнями сайтов, вот наиболее распространенные ошибки SEO:
1. Переоптимизация ключевыми словами
2. Игнорирование мобильной оптимизации
3. Плохая внутренняя перелинковка
4. Дублированный контент
5. Пренебрежение локальным SEO для бизнеса, ориентированного на определенное местоположение

## Заключение

Внедрение эффективных SEO-стратегий требует сочетания технических знаний, качественного контента и постоянной оптимизации.
Начните с основ, изложенных в этом руководстве, а затем расширяйте свои усилия по мере накопления опыта и получения результатов.

Последнее обновление: 15 апреля 2025 г.
Автор: Иван Петров, SEO-специалист с 8-летним опытом работы в цифровом маркетинге
Источники: Google Search Central, Semrush Research 2024, Ahrefs SEO Handbook
"""

def test_content_improvement():
    """Тестирование улучшения контента по рекомендациям."""
    print("\n" + "*"*80)
    print("ТЕСТИРОВАНИЕ УЛУЧШЕНИЯ КОНТЕНТА ПО РЕКОМЕНДАЦИЯМ")
    print("*"*80)
    print(f"Дата и время: {datetime.now().strftime('%Y-%m-%d %H:%M:%S')}")
    
    # Создаем экземпляр улучшенного SEO Advisor
    enhanced_advisor = EnhancedSEOAdvisor(industry="digital_marketing")
    
    # Анализируем исходный контент среднего уровня
    print("\n" + "="*80)
    print("АНАЛИЗ ИСХОДНОГО КОНТЕНТА СРЕДНЕГО УРОВНЯ")
    print("="*80)
    
    original_result = enhanced_advisor.analyze_content(
        content=MEDIUM_QUALITY_CONTENT,
        target_keywords=["seo", "оптимизация", "поисковые системы", "контент"]
    )
    
    # Вывод ключевых метрик оригинального контента
    print(f"\nОсновные метрики исходного контента:")
    print(f"   - Количество слов: {original_result.content_metrics.get('word_count')}")
    print(f"   - E-E-A-T оценка: {original_result.content_metrics.get('overall_eeat_score')}")
    print(f"   - Предсказанная позиция: {original_result.predicted_position}")
    print(f"   - Вероятность попадания в топ-10: {original_result.position_probabilities.get('top10', 0)*100:.1f}%")
    
    # Вывод основных рекомендаций
    print("\nТоп-5 рекомендаций для улучшения:")
    for i, task in enumerate(original_result.priorities[:5], 1):
        print(f"   {i}. {task['task']}")
    
    # Анализируем улучшенный контент
    print("\n" + "="*80)
    print("АНАЛИЗ УЛУЧШЕННОГО КОНТЕНТА")
    print("="*80)
    
    improved_result = enhanced_advisor.analyze_content(
        content=IMPROVED_CONTENT,
        target_keywords=["seo", "оптимизация", "поисковые системы", "контент"]
    )
    
    # Вывод ключевых метрик улучшенного контента
    print(f"\nОсновные метрики улучшенного контента:")
    print(f"   - Количество слов: {improved_result.content_metrics.get('word_count')}")
    print(f"   - E-E-A-T оценка: {improved_result.content_metrics.get('overall_eeat_score')}")
    print(f"   - Предсказанная позиция: {improved_result.predicted_position}")
    print(f"   - Вероятность попадания в топ-10: {improved_result.position_probabilities.get('top10', 0)*100:.1f}%")
    
    # Сравнение результатов
    print("\n" + "="*80)
    print("СРАВНЕНИЕ РЕЗУЛЬТАТОВ")
    print("="*80)
    
    word_count_diff = improved_result.content_metrics.get('word_count') - original_result.content_metrics.get('word_count')
    eeat_diff = improved_result.content_metrics.get('overall_eeat_score') - original_result.content_metrics.get('overall_eeat_score')
    position_diff = original_result.predicted_position - improved_result.predicted_position
    top10_diff = improved_result.position_probabilities.get('top10', 0) - original_result.position_probabilities.get('top10', 0)
    
    print(f"\nИзменения после улучшения контента:")
    print(f"   - Увеличение объема: +{word_count_diff} слов ({word_count_diff/original_result.content_metrics.get('word_count')*100:.1f}%)")
    print(f"   - Изменение E-E-A-T оценки: {eeat_diff:+.3f} ({eeat_diff/max(0.001, original_result.content_metrics.get('overall_eeat_score'))*100:+.1f}%)")
    print(f"   - Улучшение предсказанной позиции: {position_diff:+.1f} позиций")
    print(f"   - Изменение вероятности топ-10: {top10_diff*100:+.1f}%")
    
    print("\nКлючевые улучшения:")
    for key in original_result.content_metrics.keys():
        if key in improved_result.content_metrics:
            orig_val = original_result.content_metrics.get(key, 0)
            impr_val = improved_result.content_metrics.get(key, 0)
            
            if isinstance(orig_val, (int, float)) and isinstance(impr_val, (int, float)):
                if orig_val > 0 and (abs(impr_val - orig_val) / orig_val > 0.2 or abs(impr_val - orig_val) > 0.1):
                    print(f"   - {key}: {orig_val:.2f} → {impr_val:.2f} ({(impr_val-orig_val)/max(0.001, orig_val)*100:+.1f}%)")
    
    print("\n" + "*"*80)
    print("ТЕСТИРОВАНИЕ ЗАВЕРШЕНО")
    print("*"*80)
    
    return {
        "original": original_result,
        "improved": improved_result
    }

if __name__ == "__main__":
    test_content_improvement()
